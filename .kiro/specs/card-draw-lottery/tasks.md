# 实现计划

- [x] 1. 扩展类型定义和音效管理器




  - 在 `types/index.ts` 中添加卡牌抽奖相关的类型定义
  - 扩展 `lib/sound-manager.ts` 添加卡牌专用音效生成方法
  - _需求: 1.1, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 2. 创建核心卡牌组件





- [x] 2.1 实现 PlayingCard 组件


  - 创建 `components/playing-card.tsx` 组件，实现单张卡牌的渲染和翻转动画
  - 实现3D翻转效果，支持正面和背面显示
  - 添加点击/触摸交互处理
  - _需求: 4.1, 4.2, 4.3, 4.4, 7.3, 8.3, 8.4_

- [x] 2.2 实现 CardDeck 组件




  - 创建 `components/card-deck.tsx` 组件，实现卡牌堆叠和洗牌动画
  - 实现洗牌动画效果，卡牌随机位移和旋转
  - 集成洗牌音效播放
  - _需求: 2.1, 2.2, 2.3, 2.4, 5.1_

- [x] 2.3 实现 CardFlipGame 主游戏组件


  - 创建 `components/card-flip-game.tsx` 核心游戏逻辑组件
  - 实现游戏状态管理 (idle, shuffling, dealing, waiting, revealing, finished)
  - 实现发牌动画，卡牌从牌堆滑出到指定位置
  - 集成发牌和翻牌音效
  - _需求: 1.1, 1.2, 3.1, 3.2, 3.3, 3.4, 3.5, 4.5, 5.2, 5.3_

- [x] 3. 实现卡牌样式系统




- [x] 3.1 创建卡牌样式配置


  - 在 `lib/card-styles.ts` 中定义卡牌样式配置
  - 实现至少3种不同的卡牌背面设计
  - 创建样式选择器组件
  - _需求: 8.1, 8.2, 8.4_

- [x] 3.2 实现响应式布局系统


  - 在 CardFlipGame 组件中实现响应式卡牌布局
  - 桌面端横向排列，移动端适配布局
  - 确保最小触摸区域符合标准
  - _需求: 7.1, 7.2, 7.3, 7.4_

- [x] 4. 创建卡牌抽奖页面




- [x] 4.1 实现主抽奖页面


  - 创建 `app/draw/card-flip/page.tsx` 页面组件
  - 集成 CardFlipGame 组件
  - 实现页面状态管理和配置加载
  - 添加音效控制和返回导航
  - _需求: 1.1, 1.3, 5.5, 6.1, 6.2_

- [x] 4.2 集成抽奖结果处理


  - 在卡牌抽奖页面中集成现有的 DrawResultModal 组件
  - 实现抽奖完成后的结果展示
  - 添加重新抽奖功能，支持不允许重复中奖的逻辑
  - _需求: 6.1, 6.2, 6.3, 6.4_

- [x] 5. 实现音效和交互优化




- [x] 5.1 完善音效系统


  - 测试和优化所有卡牌相关音效
  - 实现音效音量控制和静音功能
  - 确保音效在不同设备上正常工作
  - _需求: 5.1, 5.2, 5.3, 5.4, 5.5, 7.5_

- [x] 5.2 优化动画性能


  - 优化所有动画效果，确保在不同设备上流畅运行
  - 实现动画降级策略，处理性能较差的设备
  - 添加动画完成后的清理逻辑
  - _需求: 7.4_

- [x] 6. 编写测试用例






- [x] 6.1 创建组件单元测试




  - 为 PlayingCard、CardDeck、CardFlipGame 组件编写单元测试
  - 测试组件渲染、状态变化和事件处理
  - 验证动画触发和完成逻辑
  - _需求: 1.1, 2.1, 3.1, 4.1_

- [x] 6.2 创建集成测试


  - 编写完整游戏流程的集成测试
  - 测试从洗牌到揭晓的完整用户体验
  - 验证响应式布局在不同屏幕尺寸下的表现
  - _需求: 1.1, 2.1, 3.1, 4.1, 6.1, 7.1, 7.2_

- [x] 7. 最终集成和优化





- [x] 7.1 集成到主应用


  - 确保卡牌抽取式模式在抽奖配置页面中可选
  - 测试与现有抽奖流程的集成
  - 验证路由和导航功能
  - _需求: 1.1, 1.2_

- [x] 7.2 性能优化和错误处理


  - 实现错误边界和错误处理逻辑
  - 优化内存使用和动画性能
  - 添加加载状态和错误提示
  - _需求: 1.3, 7.4, 7.5_