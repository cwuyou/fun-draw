# Implementation Plan

- [x] 1. 创建模式特定配置系统







  - 在配置页面添加 `getModeSpecificConfig` 函数，根据不同抽奖模式返回相应的配置选项
  - 实现 `ModeSpecificConfig` 接口，定义每种模式的配置特性
  - 添加模式配置的类型定义和验证逻辑
  - _Requirements: 1.1, 1.2, 4.1_

- [x] 2. 修改配置页面的数量输入逻辑



  - 更新 `handleModeChange` 函数，当选择多宫格抽奖时自动设置 quantity 为 1
  - 修改数量输入框的渲染逻辑，在多宫格模式下禁用输入并显示固定值
  - 添加模式切换时的状态重置逻辑
  - _Requirements: 1.1, 1.3, 4.3_

- [x] 3. 实现多宫格模式的UI优化



  - 在配置页面为多宫格模式添加特殊的说明文字和帮助提示
  - 修改数量输入框的样式，在禁用状态下显示为灰色背景
  - 添加蓝色背景的帮助提示框，解释多宫格抽奖的特点
  - _Requirements: 1.3, 2.1, 2.2_

- [x] 4. 更新配置验证逻辑


  - 在 `handleStartDraw` 函数中添加多宫格模式的特殊验证
  - 确保多宫格模式下 quantity 始终为 1
  - 添加配置保存时的数据验证和清理
  - _Requirements: 1.1, 4.4_

- [x] 5. 优化多宫格抽奖页面的显示









  - 在多宫格抽奖页面头部添加"单次抽取"标识徽章
  - 更新页面标题和描述，明确显示这是单次抽取模式
  - 修改结果显示文案，使用"获奖者"而不是"获奖者们"
  - _Requirements: 2.2, 2.3_

- [x] 6. 完善宫格布局和重复逻辑





  - 验证现有的 `determineGridSize` 函数是否正确处理不同项目数量
  - 确保"允许重复"设置在项目数量少于宫格数量时正确工作
  - 测试宫格填充逻辑，确保空余宫格的处理符合预期
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 5.1, 5.2, 5.3, 5.4_

- [x] 7. 添加数据迁移和兼容性处理







  - 创建 `migrateGridLotteryConfig` 函数处理现有配置数据
  - 在配置加载时检查并修正多宫格模式的 quantity 值
  - 确保向后兼容性，不影响其他抽奖模式的功能
  - _Requirements: 4.1, 4.2_

- [x] 8. 编写单元测试






  - 测试模式切换时的自动配置逻辑
  - 验证数量输入框在不同模式下的状态
  - 测试配置验证和错误处理逻辑
  - _Requirements: 1.1, 1.2, 1.3, 4.3_

- [x] 9. 编写集成测试






  - 测试完整的配置到抽奖流程
  - 验证多宫格抽奖的端到端功能
  - 测试不同项目数量下的宫格布局
  - _Requirements: 2.1, 2.2, 2.3, 3.1, 3.2, 3.3_

- [x] 10. 更新相关文档和类型定义





  - 更新 `types/index.ts` 中的相关类型注释
  - 添加新的模式配置类型定义
  - 完善错误处理的类型定义
  - _Requirements: 4.1, 4.2_